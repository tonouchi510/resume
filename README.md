# 履歴書

氏名：登内 雅人（とのうち まさと）  
生年月日：1995年5月10日  
メールアドレス：tonouchi27@gmail.com

# 自己紹介
主にコンピュータービジョン（CV）系の研究開発、設計・ソフトウェアアーキテクト、バックエンド開発（Golang, Python）などのタスクに取り組んでいます。
ただし、必要に応じてあらゆる技術を触るのが好きです。

以下、経験詳細で記載の通り、長く運用している大規模サービスから、研究開発・PoC的な技術検証含め、様々なステージの開発経験を経験してきています。

最近興味がある技術、取り組みなどは[技術ブログ](https://moai510.hatenablog.com/)に書いてます。

# 経歴

- 2020/04 ~ 現在 株式会社MIXI
- 2020/03 横浜国立大学大学院 理工学府 卒業
- 2018/03 静岡大学情報学部情報科学科 卒業
- 2024/03 静岡県立焼津中央高等学校 卒業

## 副業・業務委託歴
- 日本ディープラーニング協会 運営に関する業務（現）
- フリュー株式会社：技術顧問（画像解析・AI）
- バルス株式会社：バックエンドエンジニア（ETL基盤構築・改善）
- IVRy：リサーチエンジニア（自然言語処理）
- AI-Scholar：論文解説メディアライター（[リンク](https://ai-scholar.tech/author/tonouchi)）

# 経験詳細

## 機械学習（研究系）に関する経験
### サッカー映像解析:
- 概要：サッカーの試合映像から2Dピッチ上でのゲームの完全な状態を再構築するタスク
  - 人物検出、トラッキング、特徴抽出、人物役割分類、チームクラスタリング、ピッチ検出、ホモグラフィ変換、カメラキャリブレーション、補間、etc...（CV系のあらゆる技術を総動員する必要がある課題）
  - 技術概要 => 個人ブログからの引用 [リンク１](https://moai510.hatenablog.com/entry/20250206/1738849098)、[リンク２](https://moai510.hatenablog.com/entry/20250207/1738854212)
- 成果：
  - CVPR2025のWorkshopで開催された、SoccerNet Challenge（Game State Reconstruction）に出場し、4位入賞
    - MIXI & 株式会社Playboxとの共同参加で、[ベースライン](https://github.com/SoccerNet/sn-gamestate)の全てのモジュールを改善し（最新モデルへの追従、アルゴリズム改良など）、新しい解析アルゴリズムも追加した。結果、GS-HOTAで61.64という高スコアを達成。
  - 新規手法：「サッカーのルールなどのドメインルールを組み込んだベイジアンネットワークの構築とMLモデルの事後確率補正」を提案し、従来技術では困難だった課題を改善
    - 概要：従来の解析フレームワークでは、"GKは最大2人、審判は最大4人"などの人数制約や、"線審はピッチサイド上に存在する"などのドメイン知識を認識できていなかったため、MLモデルの予測に自然な形でこういったドメイン知識を反映させる方法を提案
    - => 論文化予定 & 特許出願済み・現在審査中
  - 外部露出
    - [会社のプレスリリース](https://mixi.co.jp/news/2025/0625/42339/)
    - [Forbes Japanからの取材記事](https://forbesjapan.com/articles/detail/81234)
      - 新規手法部分についても後半で少し語っている
- 補足：
  - 子会社化したFC東京の技術支援が目的でスタート。GSRの推論結果を使うことで、状況再現や戦術解析、それをもとにしたコーチング・スカウティングを改善できる。
  - PoCとして、解析結果は後述の「1人称三次元視点を提供する作戦盤アプリ」へ取り込んで戦術指導への応用可能性を検証

### 家族アルバム みてね でのMLモデル・アルゴリズム開発・改修  
#### 人物ごとのアルバム（顔分類）で使われるMLモデル改善:
- 特徴抽出モデル更新における後方互換性という実務課題に取り組んだ話
  - 概要：別々に学習されたモデルの特徴空間は一般に異なるものになるため、特徴抽出モデルを更新すると過去蓄積した古い特徴ベクトルと互換性がなくなり、比較ができない。そのまま新しいモデルに差し替える場合は過去に解析済みの特徴ベクトルをBackfill（再抽出）する必要がある。これを回避するために、当時のCVPRで提案されていたBackward Conpatible Trainingという、新しい特徴抽出モデルを学習する際に、旧特徴抽出モデルの特徴空間を共有するように（互換性があるように）、制約を加えた損失関数によって学習する手法を取り入れた
  - 成果：外部のイベントでスポンサー賞を受賞 => [Machine Learning Pitch](https://machine-learning-pitch.connpass.com/event/199555/) 登壇, [資料リンク](https://www.slideshare.net/slideshow/ml-245520906/245520906)
  - 補足：
    - ※実際には別の方法でモデル更新を行った（システム側でBackfillが不要になる対応を行った）
    - 現在のマルチモーダルAIの学習においては、依存するモデル群において特徴空間の互換性はより重要なテーマとなっている認識（※BCT以外にも様々な解決手段が提案されているが）

#### 人物ごとのアルバム（顔分類）で使われるクラスタリングアルゴリズムの改善:
- 概要：
  - 一定期間（1~2ヶ月とか）ごとに、家族のその期間の顔特徴ベクトルをクラスタリングしている
  - 言語：Go、クラスタリングアルゴリズム：Chinease-whispers（階層型クラスタリング）
- アルゴリズム改善内容：
  - 前の期間のクラスタリング結果の一部ノードを教師データとして活用することで、クラスタリングの半教師あり化を実現
    - 前期間のクラスタとの紐付けを以前はクラスタセンターの類似度マッチングに頼っていたが、それだとクラスタの分布が考慮されず精度低下を招いていた
  - クラスタリング結果の定量評価を実現
    - 前期間の教師データを正として、そのノードの再構成確率（Precision/Recall）などをもとに、定量評価を可能に
  - クラスタリングに適応的閾値調整の仕組みを導入
    - 上述の定量評価の仕組み導入によって、クラスタリング実行後に結果の良し悪し判断が可能になったため、状態に応じて閾値を段階的に厳しく or 緩くしながら再クラスタリング
  - => これらの結果で人物ごとのアルバムの分類精度を大幅に改善（10％程）
- 外部発信など（以下のスライドでも上記内容を詳しく触れています）
  - MLOps勉強会：[スライド](https://speakerdeck.com/tonouchi510/di-22hui-mlops-mian-qiang-hui-mitenefalsemlopsshi-qing)、[Youtubeリンク](https://www.youtube.com/watch?v=j5ykfrvsYWs)
  - [CTO Office Hour on #MIXITECHTALK #8 「家族アルバム みてね」で使われている クラスタリング技術](https://www.youtube.com/watch?v=xAlSnIH9WRI&list=PLSy1zuVb8HVmWLyZpH8dXf6QZo9V_fMld)
    - 制約付きクラスタリング（cannot-link制約などの話も）

### その他経験領域
- ベクトル検索技術
  - [GCP Vertex AI Matchingの内部技術に関する記事の翻訳担当](https://cloud.google.com/blog/ja/topics/developers-practitioners/find-anything-blazingly-fast-googles-vector-search-technology)
    - [ScaNNの論文解説記事](https://ai-scholar.tech/articles/vector-search/scann)出したのをきっかけに依頼を受けた
  - 実務でもいくつか難易度の高いケースで技術検証を実施
- CLIPを使用した写真・動画のZero-shotタグ推定を実装
  - 学習不要で最短でサービスインに成功
  - 解析器Worker（Python）、解析パイプライン（Ruby on Rails）
- SimCLRの分散学習の実装
  - 当時流行り出した頃に自己教師ありで表現学習をいくつか独自実装手法（特にSimCLR）
  - SimCLRはバッチサイズの大きさが精度に重要な要因だったため、分散学習に対応していない公式実装をマルチGPUやマルチTPUの分散学習に対応させた
  - [mixi tech note #05](https://techbookfest.org/product/6210524205285376) の2章で詳細記載 
- 論文解説など
  - 論文読んだり紹介したりは好きなので、解説記事書いたり、勉強会で紹介したりしてます
  - AI-Scholarでいくつか論文解説記事（[リンク](https://ai-scholar.tech/author/tonouchi)）を執筆
  - [日本ディープラーニング協会主催 CVPR 2020 技術報告会](https://speakerdeck.com/mixi_engineers/cvpr-2020-japan-deep-learning-association-lun-wen-shao-jie-bizinesuying-yong-li-toluo-mete)
  - [日本ディープラーニング協会主催 CVPR 2021 技術報告会](https://speakerdeck.com/tonouchi510/ri-ben-deipuraninguxie-hui-zhu-cui-cvpr-2021-ji-shu-bao-gao-hui)

## 機械学習（Dev）に関する経験
### Kubeflow Pipelinesによる実験基盤構築（MLOps）
- 概要
  - 実験環境を整えるために、Kubeflow Pipelinesを使用
  - => 実験管理の集約、再利用性向上のためのパイプライン化、分散並列実行による効率化
- 外部記事引用
  - [MLOps勉強会で登壇したスライド](https://speakerdeck.com/tonouchi510/di-22hui-mlops-mian-qiang-hui-mitenefalsemlopsshi-qing)
  - [Kubeflow Pipelinesで快適なAI研究開発環境の整備を進めた話](https://qiita.com/tonouchi510/items/74f3d1fe51cb9ba7b377)
  - [みてねブログ Kubeflow Pipelines の実装パターン例を公開します](https://team-blog.mitene.us/kubeflow-pipelines-design-pattern-e5ced1a4dd44)

### 2000万人以上が使う「家族アルバム みてね」の解析基盤（本番システム）
- みてねで日々アップロードされる大量の写真・動画を捌く解析基盤が必要
- システム構成
  - Kubernetes上に各モデルのワーカーとそれらをオーケストレーションするジョブ管理サーバーをデプロイ（helm-chartで管理）
  - MLモデルはすべてTFLiteで量子化・軽量化した上で、Pythonワーカーとして起動
  - 各ワーカー・サーバー間の連携は、SQSキューを使用（非同期にするため、スケーリングもキューサイズをもとに行うことで安定化）
- 運用
  - モデル更新時や遅延発生時などは、ポッド数やスケーリングの各種パラメータをチューニング
  - 自前のKubernetesを使用しているのでスケーリング周りはコントロールしやすい

### クライアント推論（量子化・TFLite）
- 推論コスト削減のため、サーバーで行なっていたMLモデル推論の一部をクライアント側（アプリ端末上）で実行するように移行
- 写真のアップロード時に、裏でMLモデルの推論を動かして解析結果も一緒に送るという処理が新たに必要で、この際UXの低下を招かないために、アップロード操作の影響が出来るだけ出ないようにする必要があった
  - 特に端末依存で推論に時間がかかりすぎてしまう端末もありうる点が課題
- 自分はサーバーAPIとAndroidの実装を担当し、クライアントでバックグラウンドで推論しながらタイムアウトを設け、タイムアウトしたらその推論ジョブを終了して他のためにリソース解放させるようにした。また、サーバー側ではクライアントからの推論結果が届いていない時にサーバーで解析を実行するようなバックアッププランを用意することで、多様な実行端末・実行環境が課題になる中でも、解析の実行が担保されるような仕組みにした

## ソフトウェア・アプリケーション開発に関する経験

### FC東京ファン向けアプリのバックエンドサーバーのRuby on Rails => Go移行
- 外注していたアプリを内製化するために、社内で経験者の多いGoに移行するというプロジェクト
- リソース不足で担当者がいなかったので、単独で実施
- Railsで書かれたコードを読んで仕様などを把握し、Goで書き換える
- この際、設計改善とコードのドキュメント化を目的として、DDDを取り入れてリファクタしながら移行を実施

### 1人称3次元視点（選手視点）を提供するサッカー作戦盤ツールの開発
- 背景：
  - サッカーのプロの現場を視察し、戦術指導などがホワイトボード（3人称2次元視点）で行われている状況だったので、改善できるのではないかと提案
  - 視点による戦術選択の違い
- 概要：
  - 特許出願中
- 露出：
  - [外部登壇資料リンク（WIP）]()
  - [技術ブログ](https://zenn.dev/mixi/articles/ad87d351e5c45b)

### 個人開発
#### 将棋の研究用アプリ
- WIP（リリース前）
- 技術スタック：
  - API Gateway: HASURA（CQRSでいうQueryのAPI自動生成も兼ねる）
  - Backend: Go（GraphQL, DDD）
  - Frontend: Flutter
  - DB: PostgreSQL
  - Infra: Terraform（環境: GCP, Firebase）

#### Navitime API Challenge（学生時代に出たハッカソン）
- 背景：ウーバーイーツなどのCtoC宅配サービスにおける配達員不足の問題に着目
- 概要
  - Google Map/Calender、およびNAVITIME APIを組み合わせることで、スキマ時間で最も稼げるシフトを提案
    - ※配達員の受注判断は当然報酬の大きさで変わる
  - 最適経路はヒューリスティクスを活用して探索空間を絞ることで実時間内に解けるように実装
  - https://github.com/tonouchi510/navitime-challenge
- 成果：優秀賞受賞

## その他
### 資格
- 統計検定 2級
- 応用情報技術者
- 基本情報技術者

### 技術ブログ
- [はてなブログ](https://moai510.hatenablog.com/)（最近やってることなど）
- [Qiita](https://qiita.com/tonouchi510) （最近は書いてない）

### 技術研修講師
- ソフトウェアアーキテクチャ研修 講師担当（MIXI）
  - MIXIの新卒研修として、研修自体の実施提案から資料作成まで実施
  - ソフトウェアアーキテクチャや設計について考える必要性・重要性から、個別の話題（マイクロサービス、モノリス、DDDなど）まで解説
  - [資料・動画リンク](https://zenn.dev/mixi/articles/95e0d0477c1ed7#《ソフトウェアアーキテクチャ研修》)
- Git研修 講師担当（MIXI）
  - Gitの内部構造などに関する研修の実施
  - 研修自体は従来からあったもので、講師を引き継いで資料を刷新
  - 研修内容はCodeZineにも掲載（[リンク](https://codezine.jp/article/detail/17328)）
